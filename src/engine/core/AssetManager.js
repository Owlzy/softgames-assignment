import Logger from './Logger'
import MiniSignal from "mini-signals";
import {Loader, Texture, Assets} from "pixi.js";

/**
 * @class
 * @classdesc - Loads and retrieves files
 */
export default class AssetManager {

    constructor() {
        /**
         * @type {MiniSignal}
         */
        this.signals = {};
        this.signals.loadCompleted = new MiniSignal();
        this.signals.loadProgressed = new MiniSignal();

        /**
         * @type {Logger}
         * @private
         */
        this._logger = new Logger("AssetManager");

        /**
         * @type {object}
         * @private
         */
        this._cache = {};

        /**
         * @member {Texture}
         * @private
         */
        this._fallbackTexture = null;
        const imageData = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAxXpUWHRSYXcgcHJvZmlsZSB0eXBlIGV4aWYAAHjabVDbDcMwCPxnio5gA3bwOM6jUjfo+D0HEiVRTzIcDx0Y2r6fN70GOCtpmay2WhOgTRt3EEuOvtucdLc7NEqIb3k6C4yUwIuHVqP/yOdTwF0HKxchW6Iw3wstJrA9hNidjI0GX0OohZCwF3IIdP9Wqs2m6xfmLd1h/mgYXqItmp+xTrjeWjBHmDfJkmBF1BeQ8QpJB1FYFiyFpgpe0NYHDzEc5N+dDtAPCahZaJVzgloAAAGEaUNDUElDQyBwcm9maWxlAAB4nH2RPUjDQBzFX9NKRSodLCjikKE62cVKcSxVLIKF0lZo1cHk0i9o0pKkuDgKrgUHPxarDi7Oujq4CoLgB4i74KToIiX+Lym0iPHguB/v7j3u3gFCu8ZUwxcHVM3UM8mEmC+siv5X+DCKIKKIScxopLKLObiOr3t4+HoX4Vnu5/4cw0rRYIBHJI6zhm4SbxDHNs0G533iEKtICvE58bROFyR+5Lrs8Bvnss0Czwzpucw8cYhYLPex3MesoqvEs8RhRdUoX8g7rHDe4qzWmqx7T/7CQFFbyXKd5gSSWEIKaYiQ0UQVNZiI0KqRYiBD+wkX/7jtT5NLJlcVjBwLqEOFZPvB/+B3t0YpOuMkBRLAwItlfUwC/l2g07Ks72PL6pwA3mfgSuv5621g7pP0Vk8LHwHBbeDiuqfJe8DlDjD21JB0yZa8NIVSCXg/o28qACO3wNCa01t3H6cPQI66Wr4BDg6BqTJlr7u8e7C/t3/PdPv7AS9lcvJ4CocUAAANdmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNC40LjAtRXhpdjIiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIgogICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgeG1sbnM6R0lNUD0iaHR0cDovL3d3dy5naW1wLm9yZy94bXAvIgogICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgIHhtcE1NOkRvY3VtZW50SUQ9ImdpbXA6ZG9jaWQ6Z2ltcDo5MzIyNTQyYi0wMGEyLTQxYjQtYjI0NC1mMDkyZjAwY2JlZWQiCiAgIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODAzZWMyYTgtY2Q2MS00ODg0LWJiYTUtMzc2ZDg1YWYwYmIwIgogICB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZmY2ZjRlOWEtNDNhZi00NWNmLTlmNjYtMWY4ZmNjYTllZTY4IgogICBkYzpGb3JtYXQ9ImltYWdlL3BuZyIKICAgR0lNUDpBUEk9IjIuMCIKICAgR0lNUDpQbGF0Zm9ybT0iV2luZG93cyIKICAgR0lNUDpUaW1lU3RhbXA9IjE3NDU0MjM1OTg1NDk0MzMiCiAgIEdJTVA6VmVyc2lvbj0iMi4xMC4zNCIKICAgdGlmZjpPcmllbnRhdGlvbj0iMSIKICAgeG1wOkNyZWF0b3JUb29sPSJHSU1QIDIuMTAiCiAgIHhtcDpNZXRhZGF0YURhdGU9IjIwMjU6MDQ6MjNUMTY6NTM6MTYrMDE6MDAiCiAgIHhtcDpNb2RpZnlEYXRlPSIyMDI1OjA0OjIzVDE2OjUzOjE2KzAxOjAwIj4KICAgPHhtcE1NOkhpc3Rvcnk+CiAgICA8cmRmOlNlcT4KICAgICA8cmRmOmxpCiAgICAgIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiCiAgICAgIHN0RXZ0OmNoYW5nZWQ9Ii8iCiAgICAgIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YzIwOTRmOTEtNGI0YS00YTM0LWEzOTUtNzgzZTAwZTY4ZDZkIgogICAgICBzdEV2dDpzb2Z0d2FyZUFnZW50PSJHaW1wIDIuMTAgKFdpbmRvd3MpIgogICAgICBzdEV2dDp3aGVuPSIyMDI1LTA0LTIzVDE2OjUzOjE4Ii8+CiAgICA8L3JkZjpTZXE+CiAgIDwveG1wTU06SGlzdG9yeT4KICA8L3JkZjpEZXNjcmlwdGlvbj4KIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PvB2HVsAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfpBBcPNRKfBd3PAAAgAElEQVRo3m25V6yt2XEeWLXCH3c8e5998rn59r19O7EDm83QNCHJoiRQtmU4QZbljIExfvB4Hu2HMTAjwH4dYOR58FiGbcAWHGTLFkVb3STFJtnsnG4O55578tl5/3GFKj+c1kCQVS///7aqVn1V9a2v8K/+3X/w3FNq6yLcPWhOx7C3OzmaFqHSlwbpn3ixefvWeFFXqtVfWREb671Pb++XHhoAUkGoxHBWLEXB9evh7j540/zs5s6VCz0CKUKaL+Qv/fy1Xjj5ZCcChd/7we3hXvng4fjV185pmV1ahs/27Vdf2X60b771zWurK+nDx5M337y9tb00ngx394rXnkufHJTf/vHs3HLUT+B0EalYb642B714Mp/WVo7Grq7qP/nTF+TPffPVbEFK4e7jIpDe1sVyr6G1gtq+uC3uPVwMa7x8bb3T7dy5s1uZfDisn9ukzZWBjqJWu3lwfFrY9mC5+/Dx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";
        const image = new Image();
        image.onload = () => {
            this._fallbackTexture = Texture.from(image);
        }
        image.src = imageData;

        //Assets.init(); // add any custom loading here
    }

    /**
     * Takes object array of form {name : "", uri : ""}
     * @param files {[object]}
     */
    async load(files) {
        if (files.length === 0) {
            //this.signals.loadCompleted.dispatch();
            return;
        }

        const assetsToLoad = [];

        // loop through array and add them to loader
        for (let i = 0; i < files.length; i++) {
            Assets.add({alias: files[i].name, src: [files[i].uri]});
            assetsToLoad.push(files[i].name);
        }

        this._logger.log(files);

        //load files
        const assets = await Assets.load(assetsToLoad, (progress) => this._onLoaderProgress(progress));

        this._cache = Object.assign(this._cache, assets);

        this.signals.loadCompleted.dispatch();

        return this._cache;
    }

    /**
     * @param files {[string] | string}
     */
    unload(files) {
        // todo
    }

    /**
     * @param key - frame / texture key
     * @param ext - extension
     * @returns {Texture}
     */
    texture(key, ext = "png") {
        if (this._cache[key])
            return this._cache[key];

        let texture = Texture.from(key + "." + ext);
        if (!texture)
            texture = this._fallbackTexture;

        return texture;
    }

    /**
     * @param key {string}
     * @returns {object}
     */
    data(key) {
        if (this._cache[key])
            return JSON.parse(JSON.stringify(this._cache[key]));
        else
            console.warn("json not found : ", key);
    }

    _onLoaderProgress(progress) {
        this.signals.loadProgressed.dispatch(progress * 100);
    }
}